
@{
    var WCs = ViewData["WCs"] as IEnumerable<SharedObjects.ValueObjects.VCustomer>    ;
    var FY = ViewData["FY"] as IEnumerable<SharedObjects.ValueObjects.VFiscalYear>;

    ViewData["Title"] = "Search";
}

<div class="container-fluid">
    <div class="row">
        <div class="col-md-12">
            <!-- BEGIN EXAMPLE TABLE PORTLET-->
            <div class="portlet light" style="height:1700px">
                <div class="portlet-title">

                    <div class="caption col-md-12">
                        <span class="caption-subject font-green-sharp bold uppercase">
                            Debug Headcount Sizing
                        </span>

                    </div>

                    <div class="portlet-body">

                        <div class="table-toolbar">
                            <form class="modal-body" id="">
                                <div class="pull-left">

                                    <label class="text-center bold font-green-sharp" for="txt-WC">WorkCell</label>
                                </div>
                                <div class="col-md-3 pull-left">
                                    <select class="form-control" id="txt-wc" data-search="wc" name="wc" style="color:mediumvioletred">
                                        <option value="">--Please Select--</option>

                                        @foreach (var item in @WCs.OrderByDescending(c => c.CustomerName).ToList())
                                        {
                                            <option value=@item.CustId>@item.CustomerName</option>
                                        }
                                    </select>
                                </div>

                                <div class="pull-left">

                                    <label class="text-center bold font-green-sharp" for="txt-fy">Fiscal Year</label>
                                </div>
                                <div class="col-md-3 pull-left">
                                    <select class="form-control" id="txt-fy" data-search="fy" name="fy" style="color:mediumvioletred">
                                        <option value="">--Please Select--</option>

                                        @foreach (var item in @FY.OrderByDescending(c => c.FiscalYear).ToList())
                                        {
                                            <option value=@item.FiscalYearId>@item.FiscalYear</option>
                                        }
                                    </select>
                                </div>
                                <div class="col-md-1  pull-left">
                                    <a class="btn btn-success" id="btn-search">Search</a>
                                </div>
                                <div class="col-md-1 pull-left box" id="box"></div>
                                <div class="col-md-1  pull-left">
                                </div>

                            </form>
                        </div>
                        <hr style="height:5px" />

                    </div>

                </div>
                <div id="table-rawdata" class="table-responsive col-md-12 table-responsive" style="height:500px">

                </div>
                <div id="table-debugdata" class="table-responsive col-md-12 table-responsive" style="height:250px">

                </div>
                <div id="table-debugresult" class="table-responsive col-md-12 table-responsive" style="height:700px">

                </div>
            </div>
        </div>
    </div>
</div>

@section Script{
    <script>
        function fncOnChangeTech(loggedTech, month) {
            debugger
            var crrr = `#Current-${month}`;
            var calculated = $(`${crrr}`).text();
            var result = loggedTech - calculated;
            if (result == 0) {
                $(`${crrr}`).attr("style", "background-color: yellow");
            }
            else if (result < 0) {
                $(`${crrr}`).attr("style", "background-color: red");
            }
            else {
                $(`${crrr}`).attr("style", "background-color: green");
            }
        }
        function fncOnChangeOperator(loggedOP, month) {
            debugger
            var crrr = `#Current-${month}`;
            var calculated = $(`${crrr}`).text();
            var result = loggedOP - calculated;
            if (result == 0) {
                $(`${crrr}`).attr("style", "background-color: yellow");
            }
            else if (result < 0) {
                $(`${crrr}`).attr("style", "background-color: red");
            }
            else {
                $(`${crrr}`).attr("style", "background-color: green");
            }
        }


        function closeInput(elm) {
            var td = elm.parentNode;
            var value = elm.value;
            td.setAttribute('style', 'background-color:cyan')
            td.removeChild(elm);
            td.innerHTML = value;
        }

        function addInput(elm) {
            if (elm.getElementsByTagName('input').length > 0) return;

            var value = elm.innerHTML;
            elm.innerHTML = '';

            var input = document.createElement('input');
            input.setAttribute('type', 'number');
            input.setAttribute('value', value);
            input.setAttribute('onBlur', 'closeInput(this)');
            input.setAttribute('style', 'width:100px');
            elm.appendChild(input);
            input.focus();
        }
        function addSelect(elm) {
            if (elm.getElementsByTagName('select').length > 0) return;

            var value = elm.innerHTML;
            elm.innerHTML = '';

            var select = document.createElement('select');
            $(select).append("<option value='2'>4-3</option>");
            $(select).append("<option value='1'>4-2</option>");
            $(select).append("<option value='3'>Regular Shift</option>");
            select.setAttribute('value', value);
            select.setAttribute('onBlur', 'closeSelect(this)');

            elm.appendChild(select);
            select.focus();
        }
        function closeSelect(elm) {
            var td = elm.parentNode;
            var value = elm.value;
            var selected = elm.options[elm.selectedIndex].text;

            debugger
            td.setAttribute('style', 'background-color:cyan')
            td.setAttribute('data-shiftId', value)
            td.removeChild(elm);
            td.innerHTML = selected;
        }


    </script>
    <script src="~/js/tableToExcel.js"></script>

    <script src="~/js/debug.js"></script>
}
